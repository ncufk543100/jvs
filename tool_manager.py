根据对现有代码的审计结果，重写 `tool_manager.py`。重点将放在：
1.  **工具库自动维护的严谨性**：实现更健壮的工具注册、发现和验证机制。引入工具元数据（如输入/输出规范、潜在风险、依赖项、版本信息）的严格校验，确保工具库的完整性和一致性。
2.  **依赖与兼容性管理**：设计机制来自动检测工具间的依赖关系和潜在的兼容性问题，并在工具更新或删除时提供预警或自动解决方案。
3.  **工具健康监控**：集成工具的自检功能或定期运行模拟测试，确保工具的可用性和性能。当工具出现问题时，能够自动标记、禁用或尝试修复。
4.  **动态加载与卸载**：优化工具的动态加载和卸载机制，提高资源利用率和系统灵活性。